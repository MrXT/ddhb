<!DOCTYPE html>
<html>
	<head>
		  <title>驾驶员培训行管平台</title>
		  <meta charset="utf-8">
		  <meta name="viewport" content="width=device-width, 
		                                     initial-scale=1.0, 
		                                     maximum-scale=1.0, 
		                                     user-scalable=no">
		  <link rel="stylesheet" href="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap.min.css">  
		  <script src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
		  <script src="http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js"></script>
		  <link rel="stylesheet" href="css/bookstatdail.css" type="text/css" />
	</head>
	<body>
		
	<table style="width:100%;height:4rem;">
    	<tr class="row" style="height:100%;width:100%;background:#2BB464;">
    		<td class="col-xs-1 btn-primary" style="height:100%;text-align:center;background:#2BB464;" onclick="reback()"><img style="width:1rem;height:1.4rem;" src='img/ic_reback.png'/></td>
    		<td class="col-xs-11" style="height:100%;text-align:left;"><strong id="title_txt" style="color:#ffffff;font-size:1.7rem;">预约统计详情</strong></td>
    	</tr>
    </table>
    <div class="input-group" style="margin-top:1.6rem;">
        	 <input type="text" class="form-control" placeholder="请输入学员名称" id="input_content">
	         <span class="input-group-addon btn-success" onclick="onclickSearch()">点击查询</span>
    </div>
    <table border="0" id="book_data_list" style="margin-top:1.6rem;">
	</table>
	
    <script type="text/javascript">
            $(function(){
            	//loadCoachesData("/ZgGwork/order");
            	GetArgsFromHref(location.href,"data");
			}); 
			
			function loadCoachesData(url,scode,sdate,edate,name){
	  			  $.ajax({
					url:url,
					type:'post',
					data:{'schoolCode':scode,'pageSize':'50','pageIndex':'1','beginTime':sdate,'endTime':edate,'keyStr':name},
					success:function(result){
	  				if(result!=null){
  				        var dataObj = result;
  			        	if(dataObj!=null){
  			        		var dataList = dataObj.data;
  			        		if(dataList==null || dataList[0].StudentName==undefined){
  	  			        	  alert("未获取到相关数据!");	
  	  			        	  return;
  	  			        	}
  			        		/*var dataListObj = eval("("+dataList+")");
  			        		if(dataListObj==null){
  			        		  alert("数据解析异常!");	
  			        		  return;
  	  	  			        }*/
  	  	  			        var tempData = null;
  	  	  				    var htmlHeader = '<tr class="row" style="height:4rem;"><td class="col-xs-3" style="font-size:1.5rem;">姓名</td><td class="col-xs-2" style="font-size:1.5rem;">性别</td><td class="col-xs-3" style="font-size:1.5rem;">所学车型</td><td class="col-xs-4" style="font-size:1.5rem;">预约时间</td></tr>';
  	  	  				    var htmlStr = "";
  			        		for(var i=0;i<dataList.length;i++){
  			        			tempData = dataList[i];
  			        			if(tempData!=null){
  			        				htmlStr+='<tr class="row" style="height:4rem;"><td class="col-xs-3" style="font-size:1.5rem;">'+tempData.StudentName+'</td><td class="col-xs-2" style="font-size:1.5rem;">'+tempData.Gender+'</td><td class="col-xs-3" style="font-size:1.5rem;">'+tempData.CarTypeName+'</td><td class="col-xs-4" style="font-size:1.5rem;">'+tempData.BeginTime+'-'+tempData.EndTime+'</td></tr>';
		                        }
  			        	    }
  			        		$("#book_data_list").html("");
  			        		$("#book_data_list").append(htmlHeader+htmlStr).show();
			        			isCreateCoachesData = true;
  				       }
  			         }
				},error:function (XMLHttpRequest, textStatus, errorThrown) {}
				});
	  		}
	  	    var schoolId = null;
			function GetArgsFromHref(sHref, sArgName) {
			    var args = sHref.split("?");
			    var retval = "";
			    if (args[0] == sHref) /*参数为空*/ {
			        return retval; /*无需做任何处理*/
			    }
			    var str = args[1];
			    args = str.split("&");
			    for (var i = 0; i < args.length; i++) {
			        str = args[i];
			        var arg = str.split("=");
			        if (arg.length <= 1) continue;
			        if (arg[0] == sArgName) retval = arg[1];
			    }
			    var data = decodeURI(retval);
			    data = eval("("+data+")");
			    schoolId = data.SchoolCode;
			    //$("#title_txt").html(data.SchoolName);
			    //return retval;
			    initDate();
			}
			function initDate(){
				var myDate = new Date();
				var currentDate = myDate.getFullYear()+"-"+(myDate.getMonth()+1)+"-"+myDate.getDate();
				loadCoachesData("/ZgGwork/order",schoolId,"2012-01-01",currentDate);
			}
			function onclickSearch(){
	  			var content = $("#input_content").val();
		  			if(content==null || content=="" || content.length<1){
						alert("输入内容不能为空!");
						return;
					}
		  			var myDate = new Date();
					var currentDate = myDate.getFullYear()+"-"+(myDate.getMonth()+1)+"-"+myDate.getDate();
					loadCoachesData("/ZgGwork/order",schoolId,"2012-01-01",currentDate,content);
		  	}
			function reback()
			{
			  window.history.back(-1);
			}
		</script>
	</body>
</html>
