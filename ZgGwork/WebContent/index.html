<!DOCTYPE html>
<html>
	<head>
		  <title>驾驶员培训行管平台</title>
		  <meta charset="utf-8">
		  <meta name="viewport" content="width=device-width, 
		                                     initial-scale=1.0, 
		                                     maximum-scale=1.0, 
		                                     user-scalable=no">
		  <link rel="stylesheet" href="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap.min.css">  
		  <script src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
		  <script src="http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js"></script>
		  <link rel="stylesheet" href="css/index.css" type="text/css" />
	</head>
	<body>
		<div class="text-center" style="margin-top:4rem;">
			<strong style="color:#2BB464;font-size:2rem;">驾驶员培训行管平台</strong>
		</div>
		<div class="container" style="margin-top:6rem;">
			<input type="text" class="form-control" style="padding-left:6px;" id="username" placeholder="请输入用户名">
			<input type="text" class="form-control" style="padding-left:6px;margin-top:16px;" id="userpw" placeholder="请输入密码">
			<button type="button" class="btn" style="width:100%;margin-top:16px;background:#2BB464;color:#ffffff;" onclick="check()">登录</button>
		</div>
        
        <div class="text-center" style="margin-top:1.6rem;">
			<font>备注：请使用运政账号直接登录</font>
		</div>
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" 
		   aria-labelledby="myModalLabel" aria-hidden="true">
		   <div class="modal-dialog">
		      <div class="modal-content">
		         <div class="modal-body">
		           登录中,请稍后...
		         </div>
		     </div>
		   </div>
		 </div>
         <script type="text/javascript">
            function check(){
				var name = $("#username").val();
				var pw = $("#userpw").val();
				//alert(content);
				//$("#result").html(content);
				if(name==null || name=="" || name.length<1){
					alert("用户名不能为空!");
					return;
				}
				if(pw==null || pw=="" || pw.length<1){
					alert("密码不能为空!");
					return;
				}
				
				//执行登录逻辑
				login("/ZgGwork/login",name,pw);
			}
            function login(url,name,pw){
				 $('#myModal').modal('show');
	  			  $.ajax({
					url:url,
					type:'post',
					data:{'username':name,'psw':pw},
					success:function(result){
					$('#myModal').modal('hide');
	  				if(result!=null){
				       if(result.errcode==1){
				    	   var dataObj = result;
				    	   if(dataObj!=null){
				        		var dataList = dataObj.datas;
				        		if(dataList==null){
				        		  alert("没有获取到相关数据!");	
		  			        	  return;
		  			        	}
				        		var dataListObj = eval("("+dataList+")");
				        		if(dataListObj==null){
				        		  alert("没有获取到相关数据!");	
				        		  return;
		  	  			        }
		  	  			        var tempData = dataListObj[0];
		  	  			        if(tempData!=null){
			  	  			        localStorage["xm"]=tempData.xm;
				  	  			    localStorage["xb"]=tempData.xb;
					  	  			localStorage["xzjb"]=tempData.xzjb;
						  	  		localStorage["ssdq"]=tempData.ssdq;
						  	  	    localStorage["ssxs"]=tempData.ssxs;
			  	  			        goMain();
			  	  			    }else{
			  	  			        alert("没有获取到相关数据!");	
				  	  			    }
		  	  			  }
					   }else{
                              alert("登录失败!");
					   }
			         }
				},error:function (XMLHttpRequest, textStatus, errorThrown) {
					$('#myModal').modal('hide');
					}
				});
	  		}
			function goMain(){
				window.location.replace("main.html");
			  //window.location.href=""; 
			}
		</script>
	</body>
</html>
