<!DOCTYPE html>
<html>
	<head>
		  <title>驾驶员培训行管平台</title>
		  <meta charset="utf-8">
		  <meta name="viewport" content="width=device-width, 
		                                     initial-scale=1.0, 
		                                     maximum-scale=1.0, 
		                                     user-scalable=no">
		  <link rel="stylesheet" href="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap.min.css">  
		  <script src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
		  <script src="http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js"></script>
		  <link rel="stylesheet" href="css/schoollist.css" type="text/css" />
	</head>
	<body>
		
	<table style="width:100%;height:4rem;">
    	<tr class="row" style="height:100%;width:100%;background:#428BCA;background:#2BB464;">
    		<td class="col-xs-1 btn-primary" style="height:100%;text-align:center;background:#2BB464;" onclick="reback()"><img style="width:1rem;height:1.4rem;" src='img/ic_reback.png'/></td>
    		<td class="col-xs-11" style="height:100%;text-align:left;"><strong style="color:#ffffff;font-size:1.7rem;">车辆动态监控</strong></td>
    	</tr>
    </table>
    <!--<div style="width:100%;height:4rem;background:#428BCA;">
    	<img style="width:1rem;height:1.4rem;margin-top:1rem;" src='img/ic_reback.png'/>
    	<strong style="color:#ffffff;font-size:1.7rem;padding-top:0.5rem;">基础数据查询</strong>
    </div>-->
    <div class="list-group" id="school_list">
	</div>
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" 
		   aria-labelledby="myModalLabel" aria-hidden="true">
		   <div class="modal-dialog">
		      <div class="modal-content">
		         <div class="modal-body">
		           努力加载中,请稍后...
		         </div>
		    </div>
		   </div>
		 </div>
	<script type="text/javascript">
            $(function(){
			  //createSchoolData();
			  loadSchoolData("/ZgGwork/school");
            }); 
            function loadSchoolData(url){
            	$('#myModal').modal('show');
  			    $.ajax({
				url:url,
				type:'post',
				data:{'ssdq':localStorage["ssdq"],'ssxs':localStorage["ssxs"]},
				success:function(result){
				$('#myModal').modal('hide');
  				if(result!=null){
				        var dataObj = result;
				        if(dataObj!=null){
  			        		var dataList = dataObj.datas;
  			        		if(dataList==null){
  			        			alert("没有获取到相关数据!");	
  			        			return;
  	  			        	}
  			        		var dataListObj = eval("("+dataList+")");
  			        		if(dataListObj==null){
  			        			alert("没有获取到相关数据!");	
  			        			return;
  	  	  			        }
  	  	  			        var tempData = null;
  	  	  			        var htmlStr = "";
  			        		for(var i=0;i<dataListObj.length;i++){
  			        			tempData = dataListObj[i];
  			        			if(tempData!=null){
  			        				//alert(tempData.yhmc);
  			        				htmlStr+='<a class="list-group-item" onclick=\'selectSchool('+JSON.stringify(tempData)+');\'><h4 class="list-group-item-heading">'+tempData.yhmc+'</h4><p class="list-group-item-text"><font>车辆共计'+tempData.carcount+'辆</font></p></a>';
  			      				}
                            }
  			        		$("#school_list").append(htmlStr).show();
  							isCreateSchoolData = true;
  	  			        }
			         }
			},error:function (XMLHttpRequest, textStatus, errorThrown) {$('#myModal').modal('hide');}
			});
  		  } 
  			
			function goDetail(data){
			  window.location.href="carmoncarsdata.html?data="+data; 
			}
			var isCreateSchoolData = false;
		    //function createSchoolData(){
				//alert("创建驾校数据");
			//	var htmlStr = "";
			//	for(var i=1;i<10;i++){
			//		htmlStr+='<a class="list-group-item" onclick="javascript:selectSchool('+i+');"><h4 class="list-group-item-heading">自贡驾校'+i+'</h4><p class="list-group-item-text"><font<font style="margin-left:0.2rem;">教练共计：50人</font><font style="margin-left:1rem;">车辆共计50辆</font><font<font style="margin-left:1rem;">场地2处</font></p></a>';
			//	}
			//	$("#school_list").append(htmlStr).show();
			//	isCreateSchoolData = true;
			//}
			
			function selectSchool(data){
				//alert(data.yhmc);
				goDetail(JSON.stringify(data));
				//alert(data.yhmc);
			}
			
			function reback(){
			  window.history.back(-1);
			}
		</script>
	</body>
</html>
